# Base image
FROM ollama/ollama:latest

# Install Python
RUN apt update && \
    apt install -y python3 python3-pip && \
    pip3 install --upgrade pip

# Create app directory
WORKDIR /app

# Copy files
COPY emne.py /app/
COPY style.css /app/
COPY phybook10.pdf /app/
COPY requirements.txt /app/

# Optional: copy vectorDB if you want to include your prebuilt DB
COPY vectorDB /app/vectorDB

# Install python dependencies
RUN pip3 install -r requirements.txt

# Pull your Ollama model (important for Railway)
RUN ollama pull llama3.1

# Expose Streamlit port
EXPOSE 8501

# Run entrypoint script
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
