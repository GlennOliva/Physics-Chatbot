# Base image
FROM ollama/ollama:latest

# Install Python (Alpine Linux uses apk, not apt)
RUN apk add --no-cache python3 py3-pip

# Create app directory
WORKDIR /app

# Copy your project files
COPY emne.py /app/
COPY style.css /app/
COPY phybook10.pdf /app/
COPY requirements.txt /app/
COPY vectorDB /app/vectorDB

# Install python dependencies
RUN pip3 install --upgrade pip --break-system-packages
RUN pip3 install -r requirements.txt --break-system-packages

# Pull your Ollama model
RUN ollama pull llama3.1

# Expose Streamlit port
EXPOSE 8501

# Copy and enable entrypoint
COPY entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh

ENTRYPOINT ["/entrypoint.sh"]
